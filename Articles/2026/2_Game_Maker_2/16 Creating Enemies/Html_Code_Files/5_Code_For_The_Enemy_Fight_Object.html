<!DOCTYPE html>
<html lang="en">



<head>
    <meta name="description" content="Learn Game Maker fundamentals in this tutorial.">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4 Code for the Enemy Fight Object</title>
    
   
 
 
    
    
    <link rel="shortcut icon" href="../../../../../Images/favicon.ico" type="image/x-icon">


    

<link href="../../../../../CSS/myStyles.css" rel="stylesheet" type="text/css">
<link href="../../../../../CSS/DarkOnLight.css" rel="stylesheet" type="text/css">


<style type="text/css">
  /* Add custom styles here if needed */
</style>


</head>


<body>

<div class="wrapper">
<header class="header">
    <meta name="description" content="Learn web design fundamentals in this tutorial.">Header</header>
  
  <ul class="navigation">
   <li><a href="../../../../../index.html" class="active"title="Home">Home</a></li>
  <li><a href="../../../../../Articles-This-Week.html" class="active"title="Articles This Week">&#9729;</a></li>
  <li><a href="../../../../../Articles-By-Year.html" title= "Articles By Year">Articles By Year</a></li>
  <li><a href="../../../../../About.html" title="About">About</a></li>
</ul>

<div class = "backgroundBlack"> <p class="h2Silver"><span class="h2Gold"><span class="h2Gold">~Articles This Week~</span></span></p></div>

<article class="main">
  
  
  
  <!--Main Article -->
  
  <p class="h2Black" >~5 Code for the Enemy Fight Object~</p>
  
  
  <p class="author">By StarsInDust</p> 
  
   <p class="articleDate" style="text-align:right" >4/27/2026</p>
   
    <p class="H2LBrown"> JUST CODE</p>
   
<p>&nbsp;</p>
<p class="RecipeHeading">// ~~~~~~~~~~~~~~~     obj_enemy_fight - CREATE EVENT ~~~~~~~~</p>
<p class="code"><strong><span style="color:#00B050; ">// Fight scene enemy  initialization</span></strong></p>
<p class="code"><strong><span style="color:#00B050; ">// Sprite references (set these to  your imported sprite</span></strong><span style="color:#00B050; "> <strong>strips)</strong></span></p>
<p class="code">spr_enemy_idle = spr_enemy_idle_128;    <strong><span style="color:#00B050; ">// Your idle  sprite strip</span></strong></p>
<p class="code">spr_enemy_attack = spr_enemy_attack_128; <strong><span style="color:#00B050; ">// Your attack sprite strip</span></strong></p>
<p class="code">spr_enemy_hit = spr_enemy_hit_128;       <strong><span style="color:#00B050; ">// Your  hit sprite strip</span></strong></p>
<p class="code">spr_enemy_death = spr_enemy_death_128;   <strong><span style="color:#00B050; ">// Your death  sprite strip</span></strong></p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">// Animation settings</span></strong></p>
<p class="code">image_speed = 0;  <strong><span style="color:#00B050; ">// Start with animation stopped (in IDLE)</span></strong></p>
<p class="code">image_index = 0;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Animation state machine</span></strong></p>
<p class="code">enum ENEMY_STATE {</p>
<p class="code">    IDLE,</p>
<p class="code">    ATTACK,</p>
<p class="code">    HIT,</p>
<p class="code">    DEATH,</p>
<p class="code">    DEAD</p>
<p class="code">}</p>
<p class="code">&nbsp;</p>
<p class="code">current_state = ENEMY_STATE.IDLE;</p>
<p class="code">sprite_index = spr_enemy_idle;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">// Enemy stats</span></strong></p>
<p class="code">max_hp = 100;</p>
<p class="code">current_hp = max_hp;</p>
<p class="code">attack_damage = 15;</p>
<p class="code">is_defending = false;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">// Combat timing</span></strong></p>
<p class="code">attack_cooldown = 0;</p>
<p class="code">attack_cooldown_max = 120; // 2 seconds at 60 FPS</p>
<p class="code">hit_flash_timer = 0;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Animation completion tracking</span></strong></p>
<p class="code">animation_complete = false;</p>
<p class="code">attack_has_dealt_damage = false;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Scale for 128px sprites (if needed for positioning)</span></strong></p>
<p class="code">image_xscale = 1;</p>
<p class="code">image_yscale = 1;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">// Position offset for combat  screen</span></strong></p>
<p class="code">x_target = room_width * 0.60;  <strong><span style="color:#00B050; ">// Enemy on right side (closer to hero)</span></strong></p>
<p class="code">y_target = room_height * 0.5;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Death flag</span></strong></p>
<p class="code">is_dead = false;</p>
<p class="code">death_timer = 0;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="RecipeHeading">//~~~~~~~~~~~~~~ obj_enemy_fight - STEP EVENT  ~~~~~~~~~~~~~~~~~~~~~~~~</p>
<p class="code"><strong><span style="color:#00B050; ">// Fight scene enemy logic</span></strong></p>
<p class="code"><strong><span style="color:#00B050; ">// Check if animation cycle is</span></strong><span style="color:#00B050; "> <strong>complete</strong></span></p>
<p class="code">if (floor(image_index) &gt;= image_number - 1) {</p>
<p class="code">    animation_complete =  true;</p>
<p class="code">} else {</p>
<p class="code">    animation_complete =  false;</p>
<p class="code">}</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Update timers</span></strong></p>
<p class="code">if (attack_cooldown &gt; 0) attack_cooldown--;</p>
<p class="code">if (hit_flash_timer &gt; 0) hit_flash_timer--;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">State machine</span></strong></p>
<p class="code">switch (current_state) {</p>
<p class="code">    case ENEMY_STATE.IDLE:</p>
<p class="code">        <strong><span style="color:#00B050; ">// Set idle sprite if not already set</span></strong></p>
<p class="code">        if (sprite_index !=  spr_enemy_idle) {</p>
<p class="code">            sprite_index =  spr_enemy_idle;</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0;  <strong><span style="color:#00B050; ">//  Stop animation when entering idle</span></strong></p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Check if  ready to attack</span></strong></p>
<p class="code">        if (attack_cooldown  &lt;= 0 &amp;&amp; !is_dead) {</p>
<p class="code">            <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Random  chance to attack each step</span></strong></p>
<p class="code">            if (random(100)  &lt; 2) {  <strong><span style="color:#00B050; ">//  2% chance per frame</span></strong></p>
<p class="code">                 current_state = ENEMY_STATE.ATTACK;</p>
<p class="code">                 sprite_index = spr_enemy_attack;</p>
<p class="code">                image_index  = 0;</p>
<p class="code">                image_speed  = 0.15; <strong><span style="color:#00B050; ">// Resume animation for attack</span></strong></p>
<p class="code">                 attack_has_dealt_damage = false;</p>
<p class="code">            }</p>
<p class="code">        }</p>
<p class="code">        break;</p>
<p class="code">        </p>
<p class="code">    case  ENEMY_STATE.ATTACK:</p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Set attack  sprite if not already set</span></strong></p>
<p class="code">        if (sprite_index !=  spr_enemy_attack) {</p>
<p class="code">            sprite_index =  spr_enemy_attack;</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0.15; <strong><span style="color:#00B050; ">// Ensure animation plays</span></strong></p>
<p class="code">             attack_has_dealt_damage = false;</p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Deal damage  at peak of animation (around frame 2)</span></strong></p>
<p class="code">        if  (floor(image_index) &gt;= 2 &amp;&amp; !attack_has_dealt_damage) {</p>
<p class="code">             attack_has_dealt_damage = true;</p>
<p class="code">            </p>
<p class="code">            <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Apply damage  to hero</span></strong></p>
<p class="code">            if  (instance_exists(obj_hero_fight)) {</p>
<p class="code">                with  (obj_hero_fight) {</p>
<p class="code">                     scr_take_damage(other.attack_damage);</p>
<p class="code">                }</p>
<p class="code">            }</p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Return to  idle when animation completes</span></strong></p>
<p class="code">        if  (animation_complete) {</p>
<p class="code">            current_state =  ENEMY_STATE.IDLE;</p>
<p class="code">            sprite_index =  spr_enemy_idle;</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0;  <strong><span style="color:#00B050; ">//  Stop animation in idle</span></strong></p>
<p class="code">            attack_cooldown  = attack_cooldown_max;</p>
<p class="code">        }</p>
<p class="code">        break;</p>
<p class="code">        </p>
<p class="code">    case ENEMY_STATE.HIT:</p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Set hit  sprite if not already set</span></strong></p>
<p class="code">        if (sprite_index !=  spr_enemy_hit) {</p>
<p class="code">            sprite_index =  spr_enemy_hit;</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0.15; <strong><span style="color:#00B050; ">// Ensure animation plays</span></strong></p>
<p class="code">            hit_flash_timer  = 10;</p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code">       <strong><span style="color:#00B050; "> //</span></strong> <strong><span style="color:#00B050; ">Return to idle or death when animation completes</span></strong></p>
<p class="code">        if  (animation_complete) {</p>
<p class="code">            if (current_hp  &lt;= 0) {</p>
<p class="code">                 current_state = ENEMY_STATE.DEATH;</p>
<p class="code">                 sprite_index = spr_enemy_death;</p>
<p class="code">                image_index  = 0;</p>
<p class="code">            } else {</p>
<p class="code">                 current_state = ENEMY_STATE.IDLE;</p>
<p class="code">                 sprite_index = spr_enemy_idle;</p>
<p class="code">                image_index  = 0;</p>
<p class="code">                image_speed  = 0;  <strong><span style="color:#00B050; ">//  Stop animation in idle</span></strong></p>
<p class="code">            }</p>
<p class="code">        }</p>
<p class="code">        break;</p>
<p class="code">        </p>
<p class="code">    case ENEMY_STATE.DEATH:</p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Set death  sprite if not already set</span></strong></p>
<p class="code">        if (sprite_index !=  spr_enemy_death) {</p>
<p class="code">            sprite_index =  spr_enemy_death;</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0.15; <strong><span style="color:#00B050; ">// Ensure animation plays</span></strong></p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Stop at last  frame</span></strong></p>
<p class="code">        if  (animation_complete) {</p>
<p class="code">            image_speed =  0;</p>
<p class="code">            image_index =  image_number - 1;</p>
<p class="code">            current_state =  ENEMY_STATE.DEAD;</p>
<p class="code">            death_timer =  60; <strong><span style="color:#00B050; ">// Wait 1 second before cleanup</span></strong></p>
<p class="code">        }</p>
<p class="code">        break;</p>
<p class="code">        </p>
<p class="code">    case ENEMY_STATE.DEAD:</p>
<p class="code">        death_timer--;</p>
<p class="code">        if (death_timer  &lt;= 0) {</p>
<p class="code">            <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Trigger  victory</span></strong></p>
<p class="code">            if  (instance_exists(obj_fight_controller)) {</p>
<p class="code">                 obj_fight_controller.fight_won = true;</p>
<p class="code">            }</p>
<p class="code">             instance_destroy();</p>
<p class="code">        }</p>
<p class="code">        break;</p>
<p class="code">}</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Check for death during other states</span></strong></p>
<p class="code">if (current_hp &lt;= 0 &amp;&amp; current_state !=  ENEMY_STATE.DEATH &amp;&amp; current_state != ENEMY_STATE.DEAD) {</p>
<p class="code">    current_state =  ENEMY_STATE.DEATH;</p>
<p class="code">    sprite_index = spr_enemy_death;</p>
<p class="code">    image_index = 0;</p>
<p class="code">    is_dead = true;</p>
<p class="code">}</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="RecipeHeading">// ~~~~~~~~~~~~~~~~~~ obj_enemy_fight - DRAW EVENT  ~~~~~~~~~~~~~~~</p>
<p class="code"><strong><span style="color:#00B050; ">// Draw the enemy with effects</span></strong></p>
<p class="code"><strong><span style="color:#00B050; ">// Draw enemy</span></strong><span style="color:#00B050; "> <strong>sprite</strong></span></p>
<p class="code">&nbsp;</p>
<p class="code">draw_self();</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Only draw HP bar in fight room</span></strong></p>
<p class="code">if (room == rm_fight ||  (variable_global_exists(&quot;in_fight&quot;) &amp;&amp; global.in_fight)) {</p>
<p class="code">    <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Draw HP bar  above enemy</span></strong></p>
<p class="code">    var bar_width = 100;</p>
<p class="code">    var bar_height = 8;</p>
<p class="code">    var bar_x = x -  bar_width / 2;</p>
<p class="code">    var bar_y = y -  sprite_height / 2 - 20;</p>
<p class="code">&nbsp;</p>
<p class="code">    <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Background</span></strong></p>
<p class="code">     draw_set_color(c_black);</p>
<p class="code">    draw_rectangle(bar_x -  1, bar_y - 1, bar_x + bar_width + 1, bar_y + bar_height + 1, false);</p>
<p class="code">&nbsp;</p>
<p class="code">    <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Red  background</span></strong></p>
<p class="code">    draw_set_color(c_red);</p>
<p class="code">    draw_rectangle(bar_x,  bar_y, bar_x + bar_width, bar_y + bar_height, false);</p>
<p class="code">&nbsp;</p>
<p class="code">    <strong><span style="color:#00B050; ">// Green health</span></strong></p>
<p class="code">    var hp_percent =  current_hp / max_hp;</p>
<p class="code">    draw_set_color(c_lime);</p>
<p class="code">    draw_rectangle(bar_x,  bar_y, bar_x + (bar_width * hp_percent), bar_y + bar_height, false);</p>
<p class="code">&nbsp;</p>
<p class="code">    <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Border</span></strong></p>
<p class="code">     draw_set_color(c_white);</p>
<p class="code">    draw_rectangle(bar_x -  1, bar_y - 1, bar_x + bar_width + 1, bar_y + bar_height + 1, true);</p>
<p class="code">&nbsp;</p>
<p class="code">    // <strong><span style="color:#00B050; ">HP text</span></strong></p>
<p class="code">     draw_set_halign(fa_center);</p>
<p class="code">     draw_set_valign(fa_top);</p>
<p class="code">     draw_set_color(c_white);</p>
<p class="code">    draw_text(x, bar_y +  bar_height + 4, string(current_hp) + &quot; / &quot; + string(max_hp));</p>
<p class="code">&nbsp;</p>
<p class="code">    // Reset draw settings</p>
<p class="code">     draw_set_halign(fa_left);</p>
<p class="code">     draw_set_valign(fa_top);</p>
<p class="code">     draw_set_color(c_white);</p>
<p class="code">}</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>





</article>

  
<footer class="footer"> ~ by StarsInDust ~  &#169 2023 –
<script type="text/javascript" src ="../../../../../JavaScript/FooterYearlyDate.js">
</script></footer>


  <script type="text/javascript" src ="../../../../../JavaScript/responsiveImage.js">
</script>   
       
</body>
</html>