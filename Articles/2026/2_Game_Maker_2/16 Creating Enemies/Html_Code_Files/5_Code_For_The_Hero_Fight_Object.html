<!DOCTYPE html>
<html lang="en">



<head>
    <meta name="description" content="Learn Game Maker fundamentals in this tutorial.">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5 Code for the Hero Fight Object</title>
    
   
 
 
    
    
    <link rel="shortcut icon" href="../../../../../Images/favicon.ico" type="image/x-icon">


    

<link href="../../../../../CSS/myStyles.css" rel="stylesheet" type="text/css">
<link href="../../../../../CSS/DarkOnLight.css" rel="stylesheet" type="text/css">


<style type="text/css">
  /* Add custom styles here if needed */
</style>


</head>


<body>

<div class="wrapper">
<header class="header">
    <meta name="description" content="Learn web design fundamentals in this tutorial.">Header</header>
  
  <ul class="navigation">
   <li><a href="../../../../../index.html" class="active"title="Home">Home</a></li>
  <li><a href="../../../../../Articles-This-Week.html" class="active"title="Articles This Week">&#9729;</a></li>
  <li><a href="../../../../../Articles-By-Year.html" title= "Articles By Year">Articles By Year</a></li>
  <li><a href="../../../../../About.html" title="About">About</a></li>
</ul>

<div class = "backgroundBlack"> <p class="h2Silver"><span class="h2Gold"><span class="h2Gold">~Articles This Week~</span></span></p></div>

<article class="main">
  
  
  
  <!--Main Article -->
  
  <p class="h2Black" >~5 Code for the Hero Fight Object~</p>
  
  
  <p class="author">By StarsInDust</p> 
  
   <p class="articleDate" style="text-align:right" >4/27/2026</p>
   
    <p class="H2LBrown"> JUST CODE</p>
   
<p>&nbsp;</p>
<p class="RecipeHeading">// ~~~~~~~~~~~~~~~~obj_hero_fight - CREATE EVENT  ~~~~~~~~~~~~~~~</p>
<p class="code"><strong><span style="color:#00B050; ">// Fight scene hero initialization</span></strong></p>
<p class="code"><strong><span style="color:#00B050; ">// Sprite references (set these to  your imported sprite</span></strong><span style="color:#00B050; "> <strong>strips)</strong></span></p>
<p class="code">&nbsp;</p>
<p class="code">spr_hero_idle = spr_hero_idle_128;    <strong><span style="color:#00B050; ">// Your idle  sprite strip</span></strong></p>
<p class="code">spr_hero_attack = spr_hero_attack_128; <strong><span style="color:#00B050; ">// Your attack sprite strip</span></strong></p>
<p class="code">spr_hero_hit = spr_hero_hit_128;       <strong><span style="color:#00B050; ">// Your  hit sprite strip</span></strong></p>
<p class="code">spr_hero_death = spr_hero_death_128;   <strong><span style="color:#00B050; ">// Your death  sprite strip (if you have one)</span></strong></p>
<p class="code"><strong><span style="color:#00B050; ">&nbsp;</span></strong></p>
<p class="code"><strong><span style="color:#00B050; ">// Animation settings</span></strong></p>
<p class="code">image_speed = 0;  <strong><span style="color:#00B050; ">// Start with animation stopped (in IDLE)</span></strong></p>
<p class="code">image_index = 0;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Animation state machine</span></strong></p>
<p class="code">enum HERO_STATE {</p>
<p class="code">    IDLE,</p>
<p class="code">    ATTACK,</p>
<p class="code">    HIT,</p>
<p class="code">    DEATH,</p>
<p class="code">    DEAD</p>
<p class="code">}</p>
<p class="code">&nbsp;</p>
<p class="code">current_state = HERO_STATE.IDLE;</p>
<p class="code">sprite_index = spr_hero_idle;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Combat stats (use global player stats if available)</span></strong></p>
<p class="code">if (global.hero_max_hp != undefined) {</p>
<p class="code">    max_hp =  global.hero_max_hp;</p>
<p class="code">    current_hp =  global.hero_current_hp;</p>
<p class="code">} else {</p>
<p class="code">    max_hp = 100;</p>
<p class="code">    current_hp = max_hp;</p>
<p class="code">}</p>
<p class="code">&nbsp;</p>
<p class="code">attack_damage = 20;</p>
<p class="code">is_player_turn = true;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">// Animation completion tracking</span></strong></p>
<p class="code">animation_complete = false;</p>
<p class="code">attack_has_dealt_damage = false;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Scale for 128px sprites</span></strong></p>
<p class="code">image_xscale = 1;</p>
<p class="code">image_yscale = 1;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Position for combat screen</span></strong></p>
<p class="code">x_target = room_width * 0.35;  <strong><span style="color:#00B050; ">// Hero on left side (closer to enemy)</span></strong></p>
<p class="code">y_target = room_height * 0.5;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Death flag</span></strong></p>
<p class="code">is_dead = false;</p>
<p class="code">hit_flash_timer = 0;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="RecipeHeading">// ~~~~~~~~~~~~~~~~    obj_hero_fight - STEP EVENT ~~~~~~~~~~~~~~~~~~~</p>
<p class="code"><strong><span style="color:#00B050; ">// Fight scene hero logic</span></strong></p>
<p class="code"><strong><span style="color:#00B050; ">// Check if animation cycle is</span></strong><span style="color:#00B050; "> <strong>complete</strong></span></p>
<p class="code">&nbsp;</p>
<p class="code">if (floor(image_index) &gt;= image_number - 1) {</p>
<p class="code">    animation_complete =  true;</p>
<p class="code">} else {</p>
<p class="code">    animation_complete =  false;</p>
<p class="code">}</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">// Update timers</span></strong></p>
<p class="code">if (hit_flash_timer &gt; 0) hit_flash_timer--;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">// State machine</span></strong></p>
<p class="code">switch (current_state) {</p>
<p class="code">    case HERO_STATE.IDLE:</p>
<p class="code">        <strong><span style="color:#00B050; ">// Set idle sprite if not already set</span></strong></p>
<p class="code">        if (sprite_index !=  spr_hero_idle) {</p>
<p class="code">            sprite_index =  spr_hero_idle;</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0;  <strong><span style="color:#00B050; ">//  Stop animation when entering idle</span></strong></p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Player can  initiate attack with spacebar or mouse click</span></strong></p>
<p class="code">        if (is_player_turn  &amp;&amp; !is_dead) {</p>
<p class="code">            if  (keyboard_check_pressed(vk_space) || mouse_check_button_pressed(mb_left)) {</p>
<p class="code">                 current_state = HERO_STATE.ATTACK;</p>
<p class="code">                 sprite_index = spr_hero_attack;</p>
<p class="code">                image_index  = 0;</p>
<p class="code">                image_speed  = 0.15; <strong><span style="color:#00B050; ">// Resume animation for attack</span></strong></p>
<p class="code">                 attack_has_dealt_damage = false;</p>
<p class="code">                 is_player_turn = false;</p>
<p class="code">            }</p>
<p class="code">        }</p>
<p class="code">        break;</p>
<p class="code">        </p>
<p class="code">    case HERO_STATE.ATTACK:</p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Set attack  sprite if not already set</span></strong></p>
<p class="code">        if (sprite_index !=  spr_hero_attack) {</p>
<p class="code">            sprite_index =  spr_hero_attack;</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0.15; <strong><span style="color:#00B050; ">// Ensure animation plays</span></strong></p>
<p class="code">             attack_has_dealt_damage = false;</p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Deal damage  at peak of animation (around frame 2)</span></strong></p>
<p class="code">        if  (floor(image_index) &gt;= 2 &amp;&amp; !attack_has_dealt_damage) {</p>
<p class="code">             attack_has_dealt_damage = true;</p>
<p class="code">            </p>
<p class="code">            <strong><span style="color:#00B050; ">// Apply damage to</span></strong><span style="color:#00B050; "> <strong>enemy</strong></span></p>
<p class="code">            if  (instance_exists(obj_enemy_fight)) {</p>
<p class="code">                with  (obj_enemy_fight) {</p>
<p class="code">                     scr_take_damage_enemy(other.attack_damage);</p>
<p class="code">                }</p>
<p class="code">            }</p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Return to  idle when animation completes</span></strong></p>
<p class="code">        if  (animation_complete) {</p>
<p class="code">            current_state =  HERO_STATE.IDLE;</p>
<p class="code">            sprite_index =  spr_hero_idle;</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0;  // Stop animation in idle</p>
<p class="code">            <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Enemy turn  will start naturally</span></strong></p>
<p class="code">        }</p>
<p class="code">        break;</p>
<p class="code">        </p>
<p class="code">    case HERO_STATE.HIT:</p>
<p class="code">        <strong><span style="color:#00B050; ">// Set hit sprite if not already set</span></strong></p>
<p class="code">        if (sprite_index !=  spr_hero_hit) {</p>
<p class="code">            sprite_index =  spr_hero_hit;</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0.15; <strong><span style="color:#00B050; ">// Ensure animation plays</span></strong></p>
<p class="code">            hit_flash_timer  = 10;</p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code"><strong><span style="color:#00B050; ">        //</span></strong><span style="color:#00B050; "> <strong>Return to idle or death when animation completes</strong></span></p>
<p class="code">        if  (animation_complete) {</p>
<p class="code">            if (current_hp  &lt;= 0) {</p>
<p class="code">                 current_state = HERO_STATE.DEATH;</p>
<p class="code">                if  (sprite_exists(spr_hero_death)) {</p>
<p class="code">                     sprite_index = spr_hero_death;</p>
<p class="code">                }</p>
<p class="code">                image_index  = 0;</p>
<p class="code">            } else {</p>
<p class="code">                 current_state = HERO_STATE.IDLE;</p>
<p class="code">                 sprite_index = spr_hero_idle;</p>
<p class="code">                image_index  = 0;</p>
<p class="code">                image_speed  = 0;  <strong><span style="color:#00B050; ">//  Stop animation in idle</span></strong></p>
<p class="code">                 is_player_turn = true; <strong><span style="color:#00B050; ">// Player can  attack again</span></strong></p>
<p class="code">            }</p>
<p class="code">        }</p>
<p class="code">        break;</p>
<p class="code">        </p>
<p class="code">    case HERO_STATE.DEATH:</p>
<p class="code">        <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Set death  sprite if not already set</span></strong></p>
<p class="code">        if (sprite_index !=  spr_hero_death) {</p>
<p class="code">            if  (sprite_exists(spr_hero_death)) {</p>
<p class="code">                 sprite_index = spr_hero_death;</p>
<p class="code">            }</p>
<p class="code">            image_index =  0;</p>
<p class="code">            image_speed =  0.15;  <strong><span style="color:#00B050; ">//  Ensure animation plays</span></strong></p>
<p class="code">        }</p>
<p class="code">        </p>
<p class="code">        <strong><span style="color:#00B050; ">// Game over scenario</span></strong></p>
<p class="code">        if  (animation_complete) {</p>
<p class="code">            image_speed =  0;</p>
<p class="code">            image_index =  image_number - 1;</p>
<p class="code">            current_state =  HERO_STATE.DEAD;</p>
<p class="code">            </p>
<p class="code">            <strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Trigger game  over</span></strong></p>
<p class="code">            if  (instance_exists(obj_fight_controller)) {</p>
<p class="code">                 obj_fight_controller.fight_lost = true;</p>
<p class="code">            }</p>
<p class="code">        }</p>
<p class="code">        break;</p>
<p class="code">        </p>
<p class="code">    case HERO_STATE.DEAD:</p>
<p class="code">        <strong><span style="color:#00B050; ">// Wait for game over screen</span></strong></p>
<p class="code">        break;</p>
<p class="code">}</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Check for death during other states</span></strong></p>
<p class="code">if (current_hp &lt;= 0 &amp;&amp; current_state !=  HERO_STATE.DEATH &amp;&amp; current_state != HERO_STATE.DEAD) {</p>
<p class="code">    current_state =  HERO_STATE.DEATH;</p>
<p class="code">    if  (sprite_exists(spr_hero_death)) {</p>
<p class="code">        sprite_index =  spr_hero_death;</p>
<p class="code">    }</p>
<p class="code">    image_index = 0;</p>
<p class="code">    is_dead = true;</p>
<p class="code">}</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="RecipeHeading">// ~~~~~~~~~~~~~~~~~~    obj_hero_fight - DRAW EVENT    ~~~~~~~~~~~~~~~~~</p>
<p class="code"><strong><span style="color:#00B050; ">// Draw the hero with effects</span></strong></p>
<p class="code"><strong><span style="color:#00B050; ">// Draw hero</span></strong> <strong><span style="color:#00B050; ">sprite</span></strong></p>
<p class="code">&nbsp;</p>
<p class="code">&nbsp;</p>
<p class="code">draw_self();</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Draw HP bar above hero</span></strong></p>
<p class="code">var bar_width = 100;</p>
<p class="code">var bar_height = 8;</p>
<p class="code">var bar_x = x - bar_width / 2;</p>
<p class="code">var bar_y = y - sprite_height / 2 - 20;</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Background</span></strong></p>
<p class="code">draw_set_color(c_black);</p>
<p class="code">draw_rectangle(bar_x - 1, bar_y - 1, bar_x + bar_width + 1, bar_y  + bar_height + 1, false);</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Red background</span></strong></p>
<p class="code">draw_set_color(c_red);</p>
<p class="code">draw_rectangle(bar_x, bar_y, bar_x + bar_width, bar_y +  bar_height, false);</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Green health</span></strong></p>
<p class="code">var hp_percent = current_hp / max_hp;</p>
<p class="code">draw_set_color(c_lime);</p>
<p class="code">draw_rectangle(bar_x, bar_y, bar_x + (bar_width * hp_percent),  bar_y + bar_height, false);</p>
<p class="code">&nbsp;</p>
<p class="code"><span style="color:#00B050; ">//</span> <strong><span style="color:#00B050; ">Border</span></strong></p>
<p class="code">draw_set_color(c_white);</p>
<p class="code">draw_rectangle(bar_x - 1, bar_y - 1, bar_x + bar_width + 1, bar_y  + bar_height + 1, true);</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">HP text</span></strong></p>
<p class="code">draw_set_halign(fa_center);</p>
<p class="code">draw_set_valign(fa_top);</p>
<p class="code">draw_set_color(c_white);</p>
<p class="code">draw_text(x, bar_y + bar_height + 4, string(current_hp) + &quot;  / &quot; + string(max_hp));</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Draw action prompt if player's turn</span></strong></p>
<p class="code">if (is_player_turn &amp;&amp; current_state == HERO_STATE.IDLE) {</p>
<p class="code">     draw_set_halign(fa_center);</p>
<p class="code">     draw_set_color(c_yellow);</p>
<p class="code">    draw_text(room_width /  2, room_height - 50, &quot;Press SPACE or CLICK to Attack!&quot;);</p>
<p class="code">}</p>
<p class="code">&nbsp;</p>
<p class="code"><strong><span style="color:#00B050; ">//</span></strong> <strong><span style="color:#00B050; ">Reset draw settings</span></strong></p>
<p class="code">draw_set_halign(fa_left);</p>
<p class="code">draw_set_valign(fa_top);</p>
<p class="code">draw_set_color(c_white);</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>





</article>

  
<footer class="footer"> ~ by StarsInDust ~  &#169 2023 –
<script type="text/javascript" src ="../../../../../JavaScript/FooterYearlyDate.js">
</script></footer>


  <script type="text/javascript" src ="../../../../../JavaScript/responsiveImage.js">
</script>   
       
</body>
</html>